#### 1.五种数据类型

int

String

hash

Set

Sorted Set



#### 2.查看内存中所有的key

```shell
keys *
```

#### 3.设置key的过期时间

```shell
expire key的名称 秒数（多少秒后过期）
```

#### 4.查看指定key的过期时间

```shell
ttl key名称
```

key的过期时间若为 **-1**，则表示该key是持久化的；

若为 **-2** ，则表示不存在该key;若为其他 **正整数**，则表示该key的存活时间。

将非持久化的key转换成持久化:

```shell
Persist key名称
```





### 5.使用客户端redis-cli连接已开启的redis（包括本地和远程的redis）,

* 连接本地redis

```shell
./redis-cli  #此处已经在bin目录下，所以是写的./
```

* 连接远程redis

  ```shell
  ./redis-cli -h 远程主机的ip -p 远程主机的redis端口号
  ```



### 6.redis集群

#### ”投票“机制

​	产生原因：集群中出现某节点Down掉时，此时会由其余的各节点”投票“，当多数（超过半数）节点都认为该节点down掉时（每个节点都去ping-pong一下该节点），此时该节点就是真的down掉了。正因这种”投票“机制，所以redis的集群搭建至少需要3个主节点，要保证集群的高可用，需要每个节点有一个备份机。



redis集群中，每个节点保存的数据是不一样的。那么在存数据时，应该怎么才能保证均匀地往每个节点存入数据呢？

```
Redis 集群中内置了 16384 个哈希槽，当需要在 Redis 集群中放置一个 key-value 时，redis 先对 key 使用 crc16 算法算出一个结果，然后把结果对 16384 求余数，这样每个 key 都会对应一个编号在 0-16383 之间的哈希槽，redis 会根据节点数量大致均等的将哈希槽映射到不同的节点
```



#### 搭建集群(伪集群，在同一台服务器上运行多个不同端口的redis实例)

1. 修改配置文件。先在第一个redis文件——redis01的bin目录下的redis.conf文件中修改端口号port为6001（端口号随便写）。然后还要将cluster-enable  no 设置成 yes,这是允许集群的意思。

2. 复制。将redis01复制五份（该集群一个6个节点），分别是redis02~redis06.

3. 编写启动集群的批处理文件。在这6个节点的同一目录下创建一个用于一次性启动所有的节点的批处理文件（.sh文件）。

4. 将redis源码文件中的redis-trib.rb文件拷贝到节点所在目录。

5. 安装ruby(用于运行第四步中的redis-trib.rb文件)，`yum install ruby`和`yum install rubygems`

6. 安装与当前redis同版本的`.gem文件`。

7. 使用ruby文件创建集群。该步骤会先创建各个节点，然后规划主节点和备份节点，并且为每个主节点分配哈希槽。

   ```shell
   #执行如下命令
   ./redis-trib.rb create --replicas 1 192.168.25.129:7001 192.168.25.129:7002 192.168.25.129:7003 192.168.25.129:7004 192.168.25.129:7005 192.168.25.129:7006
   #参数分析
   #--replicas后面的 1 表示每个主节点有一个备份节点
   #后面的IP:端口号表示每台服务器上的redis，因为此处是伪集群，所以IP相同。
   ```

8. 使用客户端连接集群。在上面的集群创建好了之后，接着就开始连接了，连接之前确认集群是否启动（用上面的批量处理文件启动）。然后随便进入一个节点，启动里面的客户端文件，启动命令如下：

   ```shell
   #连接至端口号为7003的节点
   ./redis-cli -p 7003 -c
   #参数分析：
   #-p 指定端口 ；  -c 指定是集群
   ```
